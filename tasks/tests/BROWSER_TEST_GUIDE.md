# 浏览器测试指南

## 测试目的
在实际浏览器环境中验证语雀 HTML 文档下载功能。

## 前置条件
✅ 开发服务器已启动: `npm run dev`
✅ 服务器运行在: http://localhost:3000

## 测试步骤

### 步骤 1: 打开应用
1. 在浏览器中访问: http://localhost:3000
2. 导航到"知识资产库"页面

### 步骤 2: 查找测试文档
1. 在文档列表中找到"发票云ISV接入指引"文档
2. 点击文档标题进入详情页

### 步骤 3: 测试下载功能
1. 在文档详情页找到"下载"按钮
2. 点击下载按钮
3. 浏览器应该开始下载文件

### 步骤 4: 验证下载的文件
1. 找到下载的文件（应该是 `发票云ISV接入指引.html`）
2. 在浏览器中打开该文件
3. 验证以下内容：
   - ✅ 文件可以正常打开
   - ✅ 中文字符显示正常（UTF-8 编码）
   - ✅ 内容完整（包含标题、正文等）
   - ✅ 没有显示 JSON 结构（如 `"id":`, `"format":` 等）

## 预期结果

### 下载的文件应该：
- 文件名: `发票云ISV接入指引.html`
- 文件类型: HTML 文档
- 文件大小: 约 2KB

### 在浏览器中打开后应该显示：
- 文档标题: "发票云ISV接入指引"
- 文档内容: 包含 ISV 接入流程、业务场景等信息
- 格式: 纯文本（因为语雀的 body_html 是 Markdown 格式）

### 注意事项：
1. **Markdown 语法显示**: 由于语雀的 `body_html` 字段实际上是 Markdown 格式的文本，所以在浏览器中会看到 Markdown 语法（如 `**`, `##`, `![图片]()` 等）。这是预期行为。

2. **图片不显示**: 图片链接指向语雀 CDN，如果没有网络连接或链接失效，图片可能无法显示。这不影响下载功能的正确性。

3. **样式问题**: 下载的 HTML 文件没有包含 CSS 样式，所以显示效果比较简单。如果需要更好的显示效果，可以在后续版本中添加基本的 CSS 样式。

## 测试检查清单

- [ ] 应用可以正常打开
- [ ] 可以找到测试文档
- [ ] 点击下载按钮后开始下载
- [ ] 下载的文件名正确（包含 .html 扩展名）
- [ ] 文件可以在浏览器中打开
- [ ] 文件内容完整
- [ ] 中文字符显示正常
- [ ] 没有显示 JSON 结构
- [ ] 文件包含完整的 HTML 文档结构（<!doctype html>, <html>, <head>, <body>）

## 如果遇到问题

### 问题 1: 下载的文件是 .json 而不是 .html
**原因**: 存储服务器可能没有重启，使用的是旧代码
**解决**: 重启开发服务器 `npm run dev`

### 问题 2: 文件内容是 JSON 格式
**原因**: 同上
**解决**: 重启开发服务器

### 问题 3: 文件无法在浏览器中打开
**原因**: 文件可能损坏或编码问题
**解决**: 检查文件编码是否为 UTF-8

### 问题 4: 中文显示乱码
**原因**: 浏览器没有正确识别 UTF-8 编码
**解决**: 检查 HTML 文件是否包含 `<meta charset="UTF-8">` 标签

## 测试完成

如果所有检查项都通过，说明下载功能修复成功！

## 额外测试（可选）

如果有 Markdown 格式的文档，可以测试：
1. 下载 Markdown 文档
2. 验证文件扩展名是 .md
3. 验证文件内容是纯文本（不包含 HTML 包装）
4. 验证 Content-Type 是 text/markdown

## 测试报告

测试完成后，请记录：
- 测试日期和时间
- 浏览器类型和版本
- 测试结果（通过/失败）
- 遇到的问题（如果有）
- 截图（可选）
