# Word 导出功能 - 测试检查清单

## 测试执行日期: ___________
## 测试人员: ___________

---

## 快速开始

### 1. 生成测试数据
```bash
npm run test:manual:setup
```

### 2. 在应用中下载测试文档
- 启动应用: `npm run dev`
- 访问文档详情页
- 为每个测试文档下载 Word 格式

### 3. 运行自动化验证
```bash
npm run test:manual:verify
```

### 4. 手动验证
按照本检查清单逐项测试

---

## 测试类别 1: 不同类型的文档

### ☐ 1.1 纯文本文档 (manual-test-plain-text)

**Microsoft Word:**
- [ ] 文件可以正常打开
- [ ] 文本内容完整
- [ ] 没有乱码
- [ ] 段落格式正确

**WPS Office:**
- [ ] 文件可以正常打开
- [ ] 文本内容完整
- [ ] 没有乱码
- [ ] 段落格式正确

**LibreOffice Writer:**
- [ ] 文件可以正常打开
- [ ] 文本内容完整
- [ ] 没有乱码
- [ ] 段落格式正确

**备注:** ___________________________________________

---

### ☐ 1.2 富文本文档 (manual-test-rich-text)

**标题层级:**
- [ ] H1 标题最大
- [ ] H2-H6 标题依次递减
- [ ] 标题样式正确

**文本样式:**
- [ ] 粗体正确显示
- [ ] 斜体正确显示
- [ ] 下划线正确显示
- [ ] 删除线正确显示
- [ ] 组合样式正确

**列表:**
- [ ] 无序列表正确
- [ ] 有序列表正确
- [ ] 嵌套列表层级正确
- [ ] 列表缩进正确

**表格:**
- [ ] 表格结构完整
- [ ] 行列数正确
- [ ] 边框显示正常
- [ ] 单元格对齐正确

**其他元素:**
- [ ] 引用块样式正确
- [ ] 链接可点击
- [ ] 分隔线显示正常

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

### ☐ 1.3 包含图片的文档 (manual-test-images)

**图片显示:**
- [ ] 所有图片都正确显示
- [ ] 图片清晰度良好
- [ ] 图片尺寸比例正确
- [ ] 图片对齐方式正确

**离线测试:**
- [ ] 断网后仍能查看图片（验证图片已内嵌）

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

### ☐ 1.4 包含代码块的文档 (manual-test-code)

**代码格式:**
- [ ] 代码块使用等宽字体
- [ ] 代码缩进保留
- [ ] 代码换行正确
- [ ] 代码块与正文区分明显

**不同语言:**
- [ ] JavaScript 代码正确
- [ ] Python 代码正确
- [ ] HTML 代码正确
- [ ] CSS 代码正确
- [ ] JSON 代码正确

**内联代码:**
- [ ] 内联代码样式正确

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

### ☐ 1.5 Lake 格式文档 (manual-test-lake)

**Lake 格式解析:**
- [ ] 文档可以正常生成
- [ ] 卡片内容正确转换
- [ ] 图片卡片转换为图片
- [ ] 代码块卡片转换为代码块

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

## 测试类别 2: 不同的 Word 软件

### ☐ 2.1 Microsoft Word (Windows)

**测试文档:**
- [ ] 纯文本文档
- [ ] 富文本文档
- [ ] 图片文档
- [ ] 代码块文档
- [ ] 综合文档

**兼容性:**
- [ ] 没有兼容性警告
- [ ] 可以正常编辑
- [ ] 保存后可以重新打开

**Word 版本:** ___________

**备注:** ___________________________________________

---

### ☐ 2.2 Microsoft Word (Mac)

**测试文档:**
- [ ] 纯文本文档
- [ ] 富文本文档
- [ ] 图片文档
- [ ] 代码块文档
- [ ] 综合文档

**兼容性:**
- [ ] 没有兼容性警告
- [ ] 可以正常编辑
- [ ] 保存后可以重新打开

**Word 版本:** ___________

**备注:** ___________________________________________

---

### ☐ 2.3 WPS Office

**测试文档:**
- [ ] 纯文本文档
- [ ] 富文本文档
- [ ] 图片文档
- [ ] 代码块文档
- [ ] 综合文档

**兼容性:**
- [ ] 格式基本正确（允许细微差异）
- [ ] 可以正常编辑
- [ ] 保存后可以重新打开

**WPS 版本:** ___________

**已知差异:** ___________________________________________

---

### ☐ 2.4 LibreOffice Writer

**测试文档:**
- [ ] 纯文本文档
- [ ] 富文本文档
- [ ] 图片文档
- [ ] 代码块文档
- [ ] 综合文档

**兼容性:**
- [ ] 格式基本正确（允许细微差异）
- [ ] 可以正常编辑
- [ ] 保存后可以重新打开

**LibreOffice 版本:** ___________

**已知差异:** ___________________________________________

---

## 测试类别 3: 边缘情况

### ☐ 3.1 空文档 (manual-test-empty)

- [ ] 文件可以正常生成
- [ ] 文件可以正常打开
- [ ] 显示文档标题
- [ ] 没有错误或崩溃
- [ ] 文件大小合理 (< 50KB)

**备注:** ___________________________________________

---

### ☐ 3.2 超大文档 (manual-test-large)

**性能测试:**
- [ ] 生成时间 < 30 秒
- [ ] 文件大小 < 100MB
- [ ] 文件可以正常打开
- [ ] 打开时间 < 10 秒
- [ ] 所有内容正确显示
- [ ] 没有性能问题

**实际数据:**
- 生成时间: _______ 秒
- 文件大小: _______ MB
- 打开时间: _______ 秒

**备注:** ___________________________________________

---

### ☐ 3.3 特殊字符文档 (manual-test-special-chars)

**字符显示:**
- [ ] 中文字符正确
- [ ] 日文字符正确
- [ ] 韩文字符正确
- [ ] Emoji 表情正确
- [ ] 特殊符号正确 (©®™€£¥)
- [ ] 数学符号正确 (∑∫√π∞)
- [ ] 引号和括号正确
- [ ] 标点符号正确

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

### ☐ 3.4 超大图片 (>10MB)

**测试步骤:**
1. 创建包含超大图片的文档
2. 下载为 Word 格式
3. 检查控制台日志

**验证:**
- [ ] 系统记录警告日志
- [ ] 文档仍然可以生成
- [ ] 图片可以正常显示
- [ ] 文件大小合理

**日志信息:** ___________________________________________

**备注:** ___________________________________________

---

## 测试类别 4: 错误处理

### ☐ 4.1 网络错误 (manual-test-error-handling)

**测试场景:**
- [ ] 包含无效图片 URL
- [ ] 包含 404 图片
- [ ] 包含 500 错误图片

**验证:**
- [ ] 系统记录警告日志
- [ ] 文档仍然可以生成
- [ ] 失败的图片被跳过
- [ ] 其他内容正常显示
- [ ] 有效图片正常显示

**日志信息:** ___________________________________________

**备注:** ___________________________________________

---

### ☐ 4.2 超时测试

**测试步骤:**
1. 创建非常复杂的文档
2. 或模拟慢速网络
3. 尝试下载

**验证:**
- [ ] 如果超过 30 秒，系统中止生成
- [ ] 显示友好的错误信息
- [ ] 不会导致应用崩溃

**实际超时时间:** _______ 秒

**备注:** ___________________________________________

---

### ☐ 4.3 磁盘空间不足

**注意:** 此测试需要特殊环境，可以跳过

- [ ] 系统检测到磁盘空间不足
- [ ] 显示友好的错误信息
- [ ] 不会导致应用崩溃
- [ ] 不会损坏现有文件

**备注:** ___________________________________________

---

## 测试类别 5: 缓存机制

### ☐ 5.1 缓存优先策略

**测试步骤:**
1. 第一次下载某个文档
2. 记录生成时间
3. 第二次下载同一文档
4. 记录生成时间

**验证:**
- [ ] 第二次下载明显更快
- [ ] 文件内容完全相同
- [ ] 日志显示使用了缓存

**实际数据:**
- 第一次生成时间: _______ 秒
- 第二次生成时间: _______ 秒

**备注:** ___________________________________________

---

### ☐ 5.2 动态生成回退

**测试步骤:**
1. 删除某个文档的 Word 缓存文件
2. 尝试下载该文档

**验证:**
- [ ] 系统检测到缓存不存在
- [ ] 自动动态生成新文档
- [ ] 生成成功并可以下载
- [ ] 新文件被缓存

**备注:** ___________________________________________

---

## 测试类别 6: 批量导出

### ☐ 6.1 批量导出多个文档

**测试步骤:**
1. 选择多个文档（至少 10 个）
2. 执行批量导出任务

**验证:**
- [ ] 所有文档都生成 Word 格式
- [ ] 任务状态正确更新
- [ ] 日志记录详细信息
- [ ] 部分失败不影响其他文档

**实际数据:**
- 文档总数: _______
- 成功数: _______
- 失败数: _______

**备注:** ___________________________________________

---

### ☐ 6.2 部分失败容错

**测试步骤:**
1. 在批量导出中包含有问题的文档
2. 执行批量导出

**验证:**
- [ ] 失败的文档被记录
- [ ] 其他文档继续处理
- [ ] 任务最终完成
- [ ] 错误日志详细记录失败原因

**备注:** ___________________________________________

---

## 综合测试

### ☐ 综合文档测试 (manual-test-comprehensive)

**包含所有元素:**
- [ ] 文本样式
- [ ] 标题层级
- [ ] 列表
- [ ] 表格
- [ ] 图片
- [ ] 代码块
- [ ] 引用
- [ ] 链接
- [ ] 分隔线
- [ ] 特殊字符

**在三个软件中测试:**
- [ ] Microsoft Word
- [ ] WPS Office
- [ ] LibreOffice Writer

**备注:** ___________________________________________

---

## 测试总结

### 统计数据

- **测试总数:** _______
- **通过数:** _______
- **失败数:** _______
- **警告数:** _______
- **通过率:** _______%

### 主要发现

1. ___________________________________________
2. ___________________________________________
3. ___________________________________________

### 严重问题

| 问题编号 | 严重程度 | 问题描述 | 状态 |
|---------|---------|---------|------|
| 1 | | | |
| 2 | | | |
| 3 | | | |

### 建议

1. ___________________________________________
2. ___________________________________________
3. ___________________________________________

### 结论

- [ ] 功能可以发布
- [ ] 需要修复后发布
- [ ] 需要重大改进

**签名:** ___________  **日期:** ___________

---

## 附录

### 测试环境

- **操作系统:** ___________
- **浏览器:** ___________
- **Node.js 版本:** ___________
- **应用版本:** ___________

### 参考文档

- 手动测试指南: `.kiro/specs/word-export-support/MANUAL_TEST_GUIDE.md`
- 需求文档: `.kiro/specs/word-export-support/requirements.md`
- 设计文档: `.kiro/specs/word-export-support/design.md`
